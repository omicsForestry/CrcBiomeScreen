test_that("TrainModels works correctly", {
  # Load the CrcBiomeScreenObject
  CrcBiomeScreenObject <- readRDS("CrcBiomeScreenObject.rds")

  # Define parameters
  model_type <- c("RF", "XGBoost")
  ClassBalance <- TRUE
  n_cv <- 10
  TaskName <- "TestTask"
  TrueLabel <- "CRC"
  num_cores <- 2

  # Call the TrainModels function
  result <- TrainModels(
    CrcBiomeScreenObject = CrcBiomeScreenObject,
    model_type = model_type,
    ClassBalance = ClassBalance,
    n_cv = n_cv,
    TaskName = TaskName,
    TrueLabel = TrueLabel,
    num_cores = num_cores
  )

  # Check if the result is not NULL and contains expected elements
  expect_true(!is.null(result))
  expect_true("ModelResult" %in% names(result))
  expect_true("ModelData" %in% names(result))

})
